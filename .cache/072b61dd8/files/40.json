{"contents":"exports.__esModule = true;\nvar lexer_1 = __fusereq(19);\nvar position_1 = __fusereq(41);\nclass TokenStream {\n  constructor(text) {\n    this.pos = 0;\n    this.tokens = lexer_1.getTokens(text).filter(t => t.type != 'COMMENT');\n  }\n  consume() {\n    const token = this.tokens[this.pos];\n    if (token) {\n      this.pos += 1;\n    }\n    return token;\n  }\n  peek() {\n    return this.tokens[this.pos];\n  }\n  last() {\n    return this.tokens[this.pos - 1];\n  }\n  expectToken(expectedType) {\n    const actual = this.consume();\n    if (!actual) {\n      throw new position_1.ParseError(`Expected \"${expectedType}\" token but found none.`, position_1.token2pos(this.last()));\n    }\n    if (actual.type != expectedType) {\n      throw new position_1.ParseError(`Expected \"${expectedType}\" token type but found \"${actual.type}\".`, position_1.token2pos(actual));\n    }\n    return actual;\n  }\n}\nexports.TokenStream = TokenStream;\n","sourceMap":"{\"version\":3,\"sources\":[\"src/tokenstream.ts\"],\"names\":[\"constructor\",\"text\",\"pos\",\"tokens\",\"lexer_1\",\"filter\",\"t\",\"type\",\"consume\",\"token\",\"peek\",\"last\",\"expectToken\",\"expectedType\",\"actual\",\"position_1\"],\"mappings\":\";;;AAGO;EAILA,YAAYC;SAFZC,MAAc;IAGZ,KAAKC,SAASC,kBAAUH,MAAMI,OAAO,AAAAC,KAAKA,EAAEC,QAAQ;;EAGtDC;UACQC,QAAQ,KAAKN,OAAO,KAAKD;QAC3BO;MACF,KAAKP,OAAO;;WAEPO;;EAGTC;WACS,KAAKP,OAAO,KAAKD;;EAG1BS;WACS,KAAKR,OAAO,KAAKD,MAAM;;EAGhCU,YAAiCC;UACzBC,SAAS,KAAKN;SAEfM;gBACOC,mCACKF,uCACbE,qBAAU,KAAKJ;;QAIfG,OAAOP,QAAQM;gBACPE,mCACKF,uCAAuCC,OAAOP,UAC3DQ,qBAAUD;;WAIPA\",\"sourcesContent\":[\"import {Token, TokenType, getTokens} from './lexer';\\r\\nimport {ParseError, token2pos} from './position';\\r\\n\\r\\nexport class TokenStream {\\r\\n  tokens: Token[];\\r\\n  pos: number = 0;\\r\\n\\r\\n  constructor(text: string) {\\r\\n    this.tokens = getTokens(text).filter(t => t.type != 'COMMENT');\\r\\n  }\\r\\n\\r\\n  consume(): Token | undefined {\\r\\n    const token = this.tokens[this.pos];\\r\\n    if (token) {\\r\\n      this.pos += 1;\\r\\n    }\\r\\n    return token;\\r\\n  }\\r\\n\\r\\n  peek(): Token | undefined {\\r\\n    return this.tokens[this.pos];\\r\\n  }\\r\\n\\r\\n  last(): Token {\\r\\n    return this.tokens[this.pos - 1];\\r\\n  }\\r\\n\\r\\n  expectToken<T extends TokenType>(expectedType: T): Token<T> {\\r\\n    const actual = this.consume();\\r\\n\\r\\n    if (!actual) {\\r\\n      throw new ParseError(\\r\\n        `Expected \\\"${expectedType}\\\" token but found none.`,\\r\\n        token2pos(this.last()),\\r\\n      );\\r\\n    }\\r\\n\\r\\n    if (actual.type != expectedType) {\\r\\n      throw new ParseError(\\r\\n        `Expected \\\"${expectedType}\\\" token type but found \\\"${actual.type}\\\".`,\\r\\n        token2pos(actual),\\r\\n      );\\r\\n    }\\r\\n\\r\\n    return actual as Token<T>;\\r\\n  }\\r\\n}\\r\\n\"]}"}